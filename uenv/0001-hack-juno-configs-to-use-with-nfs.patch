From 149415261b312edf291c27fc97a7dc384bd09a67 Mon Sep 17 00:00:00 2001
From: Marc Titinger <marc.titinger+renesas@baylibre.com>
Date: Thu, 14 Jan 2016 10:11:57 +0100
Subject: [PATCH] hack juno configs to use with nfs

Signed-off-by: Marc Titinger <marc.titinger+renesas@baylibre.com>
---
 include/configs/vexpress_aemv8a.h | 21 +++++++++++++++++++--
 1 file changed, 19 insertions(+), 2 deletions(-)

diff --git a/include/configs/vexpress_aemv8a.h b/include/configs/vexpress_aemv8a.h
index 814934a..12f25b4 100644
--- a/include/configs/vexpress_aemv8a.h
+++ b/include/configs/vexpress_aemv8a.h
@@ -197,9 +197,13 @@
 				"fdt_addr=0x83000000\0" \
 				"fdt_high=0xffffffffffffffff\0" \
 				"initrd_high=0xffffffffffffffff\0" \
+				"netmask=255.255.255.0\0"\
+				"serverip=SERVERIP\0"\
+				"bootserver=SERVERIP\0"\
+				"ipaddr=BOARDIP\0"
 
 /* Assume we boot with root on the first partition of a USB stick */
-#define CONFIG_BOOTARGS		"console=ttyAMA0,115200n8 " \
+//#define CONFIG_BOOTARGS		"console=ttyAMA0,115200n8 " \
 				"root=/dev/sda2 rw " \
 				"rootwait "\
 				"earlyprintk=pl011,0x7ff80000 debug "\
@@ -207,8 +211,17 @@
 				"androidboot.hardware=juno "\
 				"loglevel=9"
 
+#define CONFIG_BOOTARGS		"console=ttyAMA0,115200n8 " \
+				"earlyprintk=pl011,0x7ff80000 debug " \
+				"loglevel=9 " \
+				"root=/dev/nfs " \
+				"ip=BOARDIP " \
+				"nfsroot=SERVERIP:INSTALL_MOD_PATH rw " \
+				"no_console_suspend " \
+				"nfsrootdebug "
+
 /* Copy the kernel and FDT to DRAM memory and boot */
-#define CONFIG_BOOTCOMMAND	"afs load ${kernel_name} ${kernel_addr} ; " \
+//#define CONFIG_BOOTCOMMAND	"afs load ${kernel_name} ${kernel_addr} ; " \
 				"if test $? -eq 1; then "\
 				"  echo Loading ${kernel_alt_name} instead of "\
 				"${kernel_name}; "\
@@ -228,6 +241,10 @@
 				"fi ; " \
 				"booti ${kernel_addr} ${initrd_param} ${fdt_addr}"
 
+#define CONFIG_BOOTCOMMAND	"tftpboot 0x80000000 Image ; "\
+				"tftpboot 0x83000000 juno.dtb; "\
+				"booti 0x80000000 - 0x83000000"
+
 #define CONFIG_BOOTDELAY		1
 
 #elif CONFIG_TARGET_VEXPRESS64_BASE_FVP
-- 
2.1.4

